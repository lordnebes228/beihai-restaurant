<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DATA TRUCK PRO ‚Äî –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –ú–æ–¥–µ–ª—å</title>
    <style>
        :root {
            --primary: #6366f1;
            --accent: #f43f5e;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f8fafc;
            --success: #22c55e;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at top, #1e1b4b, #0f172a);
            color: var(--text);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { max-width: 1000px; width: 100%; }

        header { text-align: center; margin-bottom: 30px; }
        h1 { font-size: 3rem; margin: 0; text-transform: uppercase; letter-spacing: 4px; color: #fff; text-shadow: 0 0 20px rgba(99, 102, 241, 0.6); }

        /* –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .dashboard {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 24px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .control-item { display: flex; flex-direction: column; gap: 8px; }
        label { font-size: 0.75rem; color: #818cf8; font-weight: 800; text-transform: uppercase; }

        select {
            background: #0f172a;
            color: white;
            border: 1px solid #334155;
            padding: 12px;
            border-radius: 12px;
            outline: none;
            transition: 0.3s;
        }
        select:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(99, 102, 241, 0.3); }

        .btn-group { display: flex; gap: 10px; align-items: flex-end; }
        button {
            padding: 14px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.3s;
        }
        .btn-start { background: var(--primary); color: white; flex: 2; }
        .btn-start:hover { transform: scale(1.05); background: #4f46e5; }
        .btn-race { background: var(--accent); color: white; flex: 1; }
        .btn-race:hover { background: #e11d48; box-shadow: 0 0 20px rgba(244, 63, 94, 0.4); }

        /* –¢—Ä–∞—Å—Å—ã */
        #world { background: rgba(2, 6, 23, 0.6); padding: 25px; border-radius: 24px; border: 1px solid #1e293b; }

        .track-box { margin-bottom: 20px; position: relative; }
        .track-meta { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; font-weight: 500; }

        .road {
            height: 70px;
            background: #0f172a;
            border-radius: 15px;
            position: relative;
            display: flex;
            align-items: center;
            overflow: hidden;
            border: 2px solid #334155;
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ */
        .road::before {
            content: "";
            position: absolute;
            width: 200%;
            height: 4px;
            background: repeating-linear-gradient(90deg, #fff 0, #fff 20px, transparent 20px, transparent 40px);
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.1;
        }

        .road.moving::before { animation: dash 0.5s linear infinite; }
        @keyframes dash { to { transform: translate(-40px, -50%); } }

        .truck {
            position: absolute;
            left: 0;
            width: 80px;
            font-size: 45px;
            display: flex;
            justify-content: center;
            z-index: 5;
            cursor: pointer;
            transition: left 0.1s linear, transform 0.2s;
        }
        .truck:hover { transform: scale(1.2) rotate(-5deg); filter: brightness(1.5); }
        
        .finish-line {
            position: absolute;
            right: 10px;
            height: 80%;
            width: 10px;
            background: repeating-linear-gradient(0deg, #fff 0, #fff 10px, #000 10px, #000 20px);
            border-radius: 2px;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
        .leaderboard {
            margin-top: 20px;
            background: var(--card);
            padding: 15px;
            border-radius: 15px;
            display: none;
        }
        .leader-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #334155; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Data Truck Pro</h1>
        <p style="color: #94a3b8">–ö—É—Ä—Å–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç: –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö</p>
    </header>

    <div class="dashboard">
        <div class="control-item">
            <label>–ì—Ä—É–∑ (–î–∞–Ω–Ω—ã–µ)</label>
            <select id="cargoSize">
                <option value="10">üéµ –ê–ª—å–±–æ–º (10 –ú–ë)</option>
                <option value="100">üé¨ –ö–ª–∏–ø (100 –ú–ë)</option>
                <option value="1000">üì¶ –ü–∞–∫–µ—Ç –∏–≥—Ä (1 –ì–ë)</option>
                <option value="5000">üåå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (5 –ì–ë)</option>
            </select>
        </div>

        <div class="control-item">
            <label>–¢–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</label>
            <select id="connType">
                <option value="2">Slow 3G (2 –ú–ë/—Å)</option>
                <option value="50" selected>Standard 4G (50 –ú–ë/—Å)</option>
                <option value="400">Ultra 5G (400 –ú–ë/—Å)</option>
                <option value="1200">Optical Wi-Fi (1.2 –ì–ë/—Å)</option>
            </select>
        </div>

        <div class="control-item">
            <label>–°—Ä–µ–¥–∞ –ø–µ—Ä–µ–¥–∞—á–∏</label>
            <select id="roadQuality">
                <option value="1">–ü—É—Å—Ç–∞—è —Ç—Ä–∞—Å—Å–∞ (100%)</option>
                <option value="0.6">–ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞—Ñ–∏–∫ (-40%)</option>
                <option value="0.2">–ß–∞—Å –ø–∏–∫ / –ì—Ä–æ–∑–∞ (-80%)</option>
            </select>
        </div>

        <div class="btn-group">
            <button class="btn-start" onclick="runOne()">–ó–∞–ø—É—Å–∫</button>
            <button class="btn-race" onclick="runRace()">–ì–æ–Ω–∫–∞</button>
        </div>
    </div>

    <div id="world"></div>
    <div id="leaderboard" class="leaderboard"></div>
</div>

<script>
    const world = document.getElementById('world');
    const board = document.getElementById('leaderboard');
    const truckIcons = { '2': 'üöú', '50': 'üöö', '400': 'üèéÔ∏è', '1200': 'üöÄ' };
    let timers = [];
    let results = [];

    // –ó–≤—É–∫–æ–≤–æ–π –¥–≤–∏–∂–æ–∫ (Web Audio API)
    function playSound(freq, type, duration) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, ctx.currentTime);
        gain.gain.setValueAtTime(0.1, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start();
        osc.stop(ctx.currentTime + duration);
    }

    function createTrack(id, label, speed, cargo, quality) {
        const div = document.createElement('div');
        div.className = 'track-box';
        div.innerHTML = `
            <div class="track-meta">
                <span>${label}</span>
                <span id="speed-val-${id}">${(speed * quality).toFixed(1)} –ú–ë/—Å</span>
            </div>
            <div class="road" id="road-${id}">
                <div class="finish-line"></div>
                <div class="truck" id="truck-${id}" title="–ù–∏—Ç—Ä–æ!">
                    ${truckIcons[speed] || 'üöö'}
                </div>
            </div>
        `;
        return div;
    }

    function runOne() {
        reset();
        const s = document.getElementById('connType');
        const speed = parseFloat(s.value);
        const name = s.options[s.selectedIndex].text;
        const cargo = parseFloat(document.getElementById('cargoSize').value);
        const quality = parseFloat(document.getElementById('roadQuality').value);

        world.appendChild(createTrack(0, name, speed, cargo, quality));
        startLogic(0, name, speed, cargo, quality);
    }

    function runRace() {
        reset();
        const cargo = parseFloat(document.getElementById('cargoSize').value);
        const quality = parseFloat(document.getElementById('roadQuality').value);
        const opts = document.getElementById('connType').options;

        for (let i = 0; i < opts.length; i++) {
            const speed = parseFloat(opts[i].value);
            world.appendChild(createTrack(i, opts[i].text, speed, cargo, quality));
            startLogic(i, opts[i].text, speed, cargo, quality);
        }
    }

    function startLogic(id, name, speed, cargo, quality) {
        const truck = document.getElementById(`truck-${id}`);
        const road = document.getElementById(`road-${id}`);
        road.classList.add('moving');
        playSound(200 + speed/2, 'sawtooth', 0.5);

        let loaded = 0;
        let nitro = 1;
        const startTime = Date.now();

        // –§–∏—à–∫–∞: –ö–ª–∏–∫ –ø–æ –≥—Ä—É–∑–æ–≤–∏–∫—É –¥–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ (–ù–∏—Ç—Ä–æ)
        truck.onclick = () => { 
            nitro = 2; 
            truck.style.filter = 'drop-shadow(0 0 10px #f43f5e)';
            playSound(800, 'square', 0.1);
            setTimeout(() => { nitro = 1; truck.style.filter = 'none'; }, 1000);
        };

        const t = setInterval(() => {
            loaded += (speed * quality * nitro) / 10;
            let p = (loaded / cargo) * 100;
            if (p > 100) p = 100;

            truck.style.left = `calc(${p}% - 80px)`;

            if (p >= 100) {
                clearInterval(t);
                road.classList.remove('moving');
                const time = ((Date.now() - startTime)/1000).toFixed(2);
                results.push({name, time});
                updateBoard();
                playSound(600, 'sine', 0.3);
            }
        }, 100);
        timers.push(t);
    }

    function reset() {
        timers.forEach(clearInterval);
        world.innerHTML = '';
        board.innerHTML = '<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–µ–∑–¥–∞:</h3>';
        board.style.display = 'none';
        results = [];
    }

    function updateBoard() {
        board.style.display = 'block';
        results.sort((a,b) => a.time - b.time);
        board.innerHTML = '<h3>üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤:</h3>';
        results.forEach((r, i) => {
            board.innerHTML += `<div class="leader-item"><span>${i+1}. ${r.name}</span> <b>${r.time} —Å–µ–∫</b></div>`;
        });
    }
</script>
</body>
</html>
